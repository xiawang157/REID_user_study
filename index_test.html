<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>User Study</title>
</head>
<body>
<script src="vue.min.js"></script>
<script type="text/javascript" src="js/d3.v4.min.js"></script>
<script type="text/javascript" src="js/jquery.min.js"></script>




<!--鼠标位置-->
<input id="xxx" type="hidden" />  <input id="yyy" type="hidden" />
<div id="test">
<!--问题-->
<div id = "div_question" >
    <a>Task : 请仔细阅览该示意图</a>
<!--    <button class = "normal" id = "Submit"  name="Submit" value=Submit >开始测试</button>-->
</div>
<br>
<!--图片-->
<div id = "div_image">
    <img id = "image" src="image/test.jpg" onclick="getCoordinates(this);" />
</div>
    <button class = "normal" id = "Submit"  name="Submit" value=Submit >开始测试</button>
</div>



<div id="result" style="display:none">
    测试结果(秒):<br/>
<hr>
<textarea rows="10" cols="80" id="result_p"></textarea>
<hr>
<br/><b>亲~<br/>Another Small Favor~~<br/>请将如上分割线区域内的内容复制到下面的表单中并提交:)<br/></b>
<br/>



<style>
    .normal {
        background-color: rgb(157, 157, 158);
        color: #fff;
    }
    body{
        font-size:32px;
    }
</style>
</body>
</html>
<script>

    var start_time;
    var end_time;
    var clickcount = 0
    var path = "image/"
    flag=0

    document.onmousemove = mouseMove;


    var dataimage = [
        { "index":0,"image" : "hotrect_5.jpg","question":"Task:请点击图片中与其他方格颜色偏差最大的方格","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0},
        { "index":0,"image" : "hotrect_7.jpg","question":"Task: 请点击图片中与其他方格颜色偏差最大的方格","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0},
        { "index":0,"image" : "hotrect_14.jpg","question":"Task: 请点击图片中与其他方格颜色偏差最大的方格","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0},
        { "index":0,"image" : "hotrect_19.jpg","question":"Task: 请点击图片中与其他方格颜色偏差最大的方格","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0},
        { "index":0,"image" : "hotrect_20.jpg","question":"Task: 请点击图片中与其他方格颜色偏差最大的方格","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0},
        { "index":0,"image" : "hotrect_24.jpg","question":"Task: 请点击图片中与其他方格颜色偏差最大的方格","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0},
        { "index":0,"image" : "image_5.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的行人","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "image_7.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的行人","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "image_14.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的行人","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "image_19.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的行人","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "image_20.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的行人","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "image_24.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的行人","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "pixel_5.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的图像条","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "pixel_7.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的图像条","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "pixel_14.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的图像条","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "pixel_19.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的图像条","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "pixel_20.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的图像条","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},
        { "index":0,"image" : "pixel_24.jpg","question":"Task: 请点击在右图中与左边行人外观最不相似的图像条","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"query":1},

        { "index":0,"image" : "overview_1.1.jpg","question":"Task: 请点击图片中”内部颜色差异“更大的节点所在的区域","time":-1,"flag":1,"correct":0,"an":"A","answer":"-1"},
        { "index":0,"image" : "overview_1.2.jpg","question":"Task: 请点击图片中”内部颜色差异“更大的节点所在的区域","X1":0,"time":-1,"flag":1,"correct":0,"an":"A","answer":"-1"},
        { "index":0,"image" : "overview_1.3.jpg","question":"Task: 请点击图片中更接近正样本的节点所在的区域","time":-1,"flag":1,"correct":0,"an":"A","answer":"-1"},
        { "index":0,"image" : "overview_2.1.jpg","question":"Task: 请点击图片中更接近正样本的节点所在的区域","time":-1,"flag":1,"correct":0,"an":"A","answer":"-1"},
        { "index":0,"image" : "overview_2.2.jpg","question":"Task: 请点击图片中”内部颜色差异“更大的节点所在的区域","time":-1,"flag":1,"correct":0,"an":"B","answer":"-1"},
        { "index":0,"image" : "overview_2.3.jpg","question":"Task: 请点击图片中”rank后移“更大的节点所在的区域","time":-1,"flag":1,"correct":0,"an":"C","answer":"-1"},
        { "index":0,"image" : "path_1.jpg","question":"Task: 请点击图片中”内部颜色差异“最大的节点","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"answer":"-1"},
        { "index":0,"image" : "path_2.jpg","question":"Task: 请点击图片中”内部颜色差异“最大的节点","X1":0, "Y1": 0, "X2":100, "Y2": 100, "time":-1,"flag":0,"correct":0,"answer":"-1"}
    ]


    for(var p = 0; p <dataimage.length; p++ ){
        dataimage[p].index = p
    }

    console.log(dataimage);


    $("#Submit").click(function(d,i){
        if(clickcount >= dataimage.length) {
            showResult();
            return;
        }else{
            var questionIndex=dataimage[clickcount]
            d3.select("img").attr("src", path + questionIndex.image);//.attr("height","40%").attr("width","40%");
            d3.select("#div_question")._groups[0][0].innerHTML = questionIndex.question;
            d3.selectAll("#Submit")._groups[0][0].innerHTML = "第"+ String(clickcount+1) + "道题提交";
            console.log(clickcount);
            clickcount++;
        }
    })



    function isInside(x, y, z1, z2, z3, z4) {
        x1 = Math.min(z1, z3);
        x2 = Math.max(z1, z3);
        y1 = Math.min(z2, z4);
        y2 = Math.max(z2, z4);
        if ((x1 <= x ) && ( x <= x2) && (y1 <= y) && (y <= y2)) {
            console.log(x1 + "," + x + "," + x2);
            console.log(y1 + "," + y + "," + y2);
            return true;
        } else {
            return false;
        };
    };

    function mousePosition(ev){
        if(ev.pageX || ev.pageY){
            return {x:ev.pageX, y:ev.pageY};
        }
        return {
            x:ev.clientX + document.body.scrollLeft - document.body.clientLeft,
            y:ev.clientY + document.body.scrollTop  - document.body.clientTop
        };
    }

    function mouseMove(ev){
        ev = ev || window.event;
        var mousePos = mousePosition(ev);
        document.getElementById('xxx').value = mousePos.x;
        document.getElementById('yyy').value = mousePos.y;
    }


    function getCoordinates(el){
        var x = parseInt(document.getElementById('xxx').value)-el.offsetLeft;
        var y = parseInt(document.getElementById('yyy').value)-el.offsetTop;
        var questionIndex=dataimage[clickcount];
        console.log("X:"+x+",Y:"+y);
    }

    function showResult(){
        document.getElementById("test").style.display='none';
        document.getElementById("result").style.display='';
        document.getElementById("result_p").value = "";
        //document.getElementById("result").innerHTML = "测试结果(秒):<br/>";
        var re = "";
        for(var i = 0; i <dataimage.length ; i++){
            re += dataimage[i].time;
            re +=",";
        }
        document.getElementById("result_p").value += "Embed:"
        document.getElementById("result_p").value += re;

    }

</script>
